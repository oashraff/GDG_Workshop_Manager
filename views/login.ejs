<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Secure login for GDG EUE event organisers">
    <meta name="robots" content="noindex, nofollow">
    
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='40' fill='%234285f4'/%3E%3Ctext x='50' y='60' text-anchor='middle' fill='white' font-family='sans-serif' font-size='40' font-weight='bold'%3EG%3C/text%3E%3C/svg%3E">
    <link rel="stylesheet" type="text/css" href="/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <title><%= title || 'Organiser Login - GDG EUE' %></title>
    
    <!-- Security headers for login page -->
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
</head>
<body style="background: linear-gradient(135deg, var(--google-blue-50), var(--google-green-50)); min-height: 100vh;">
    <!-- Header with minimal navigation -->
    <header class="header">
        <div class="container">
            <a href="/" class="logo">
                <div class="logo-icon">G</div>
                GDG On Campus EUE
            </a>
            
            <nav class="nav">
                <a href="/attendee" class="nav-link">Browse Workshops</a>
            </nav>
        </div>
    </header>

    <!-- Main Login Content -->
    <main style="display: flex; align-items: center; justify-content: center; min-height: calc(100vh - 80px); padding: var(--spacing-lg) 0;">
        <div class="container-narrow">
            <div class="card" style="max-width: 400px; margin: 0 auto; box-shadow: var(--shadow-xl);">
                <div class="card-header text-center" style="background: linear-gradient(135deg, var(--google-blue), var(--google-green)); color: white;">
                    <h1 style="color: white; margin-bottom: var(--spacing-sm); font-size: 1.5rem;">Organiser Access</h1>
                    <p style="margin: 0; opacity: 0.9; font-size: 0.875rem;">GDG EUE Workshop Manager</p>
                </div>
                
                <div class="card-body">
                    <!-- Success Message -->
                    <% if (typeof message !== 'undefined' && message) { %>
                        <div class="alert alert-success" role="alert">
                            <%= message %>
                        </div>
                    <% } %>
                    
                    <!-- Error Messages -->
                    <% if (typeof error !== 'undefined' && error) { %>
                        <div class="alert alert-error" role="alert">
                            <strong>Access Denied:</strong> <%= error %>
                        </div>
                    <% } %>
                    
                    <!-- Login Form -->
                    <form action="/login" method="POST" novalidate>
                        <!-- CSRF Protection -->
                        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                        
                        <!-- Username Field -->
                        <div class="form-group">
                            <label for="username" class="form-label">
                                Username or Email
                                <span style="color: var(--google-red);" aria-label="Required">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="username" 
                                name="username" 
                                class="form-control" 
                                required 
                                autocomplete="username"
                                placeholder="Enter your username or email"
                                minlength="3"
                                aria-describedby="username-help"
                            >
                            <div id="username-help" class="form-text">
                                Use your assigned organiser username or email address.
                            </div>
                        </div>
                        
                        <!-- Password Field -->
                        <div class="form-group">
                            <label for="password" class="form-label">
                                Password
                                <span style="color: var(--google-red);" aria-label="Required">*</span>
                            </label>
                            <div style="position: relative;">
                                <input 
                                    type="password" 
                                    id="password" 
                                    name="password" 
                                    class="form-control" 
                                    required 
                                    autocomplete="current-password"
                                    placeholder="Enter your password"
                                    style="padding-right: 3rem;"
                                    minlength="1"
                                    aria-describedby="password-help"
                                >
                                <button 
                                    type="button" 
                                    id="toggle-password" 
                                    class="btn btn-icon"
                                    style="
                                        position: absolute; 
                                        right: var(--spacing-xs); 
                                        top: 50%; 
                                        transform: translateY(-50%); 
                                        background: transparent; 
                                        border: none; 
                                        color: var(--google-grey-600); 
                                        cursor: pointer;
                                        padding: var(--spacing-xs);
                                        border-radius: var(--border-radius-sm);
                                        min-height: 32px;
                                        min-width: 32px;
                                    "
                                    aria-label="Toggle password visibility"
                                    title="Show/hide password"
                                >
                                    <span class="material-icon">visibility</span>
                                </button>
                            </div>
                            <div id="password-help" class="form-text">
                                Use your GDG organiser credentials to access the workshop management dashboard.
                            </div>
                        </div>
                        
                        <!-- Remember Me Option -->
                        <div class="form-check">
                            <input 
                                type="checkbox" 
                                id="remember" 
                                name="remember" 
                                class="form-check-input"
                                aria-describedby="remember-help"
                            >
                            <label for="remember" class="form-check-label">
                                Remember me for 7 days
                            </label>
                        </div>
                        <div id="remember-help" class="form-text" style="margin-top: 0;">
                            Only use this option on your personal, secure device.
                        </div>
                        
                        <!-- Submit Button -->
                        <button type="submit" class="btn btn-primary btn-large" style="width: 100%; margin-top: var(--spacing-lg);">
                            <span id="login-text">Sign In to Dashboard</span>
                            <span id="login-spinner" class="spinner" style="display: none;"></span>
                        </button>
                    </form>
                </div>
                
                <!-- Security Information -->
                <div class="card-footer" style="background: var(--google-grey-50);">
                    <div style="font-size: 0.75rem; color: var(--google-grey-600); text-align: center;">
                        <p style="margin-bottom: var(--spacing-xs);">
                            Secured with industry-standard encryption
                        </p>
                        <p style="margin: 0;">
                            Maximum 5 attempts per 15 minutes for security
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Help Information -->
            <div class="card" style="max-width: 400px; margin: var(--spacing-lg) auto 0; background: var(--google-blue-50); border: none;">
                <div class="card-body text-center">
                    <h3 style="color: var(--google-blue-700); margin-bottom: var(--spacing-md); font-size: 1.125rem;">
                        Need Access?
                    </h3>
                    <p style="color: var(--google-grey-700); margin-bottom: var(--spacing-md); font-size: 0.875rem;">
                        If you're a GDG member who should have organiser access, please contact the GDG lead or 
                        technical administrator.
                    </p>
                    <a href="mailto:gdg@uol.eue.edu.eg" class="btn btn-outline" style="border-color: var(--google-blue); color: var(--google-blue);">
                        Contact Administrator
                    </a>
                </div>
            </div>
            
            <!-- Academic Project Notice -->
            <div style="text-align: center; margin-top: var(--spacing-xl); padding: var(--spacing-md);">
                <p style="font-size: 0.75rem; color: var(--google-grey-600); margin: 0;">
                    Academic Project - Midterm Coursework Assignment<br>
                    Developed by Omar Ashraf Mohammed, April 2025
                </p>
            </div>
        </div>
    </main>

    <!-- JavaScript for Enhanced UX -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const passwordInput = document.getElementById('password');
            const toggleButton = document.getElementById('toggle-password');
            const loginForm = document.querySelector('form');
            const loginText = document.getElementById('login-text');
            const loginSpinner = document.getElementById('login-spinner');
            
            // Password visibility toggle
            toggleButton.addEventListener('click', function() {
                const isPassword = passwordInput.type === 'password';
                passwordInput.type = isPassword ? 'text' : 'password';
                
                // Toggle between eye and eye-slash icons
                const eyeIcon = this.querySelector('.icon-eye');
                if (isPassword) {
                    eyeIcon.innerHTML = `
                        <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                        <line x1="1" y1="1" x2="23" y2="23"></line>
                    `;
                } else {
                    eyeIcon.innerHTML = `
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    `;
                }
                
                this.setAttribute('aria-label', isPassword ? 'Hide password' : 'Show password');
            });
            
            // Form submission handling
            loginForm.addEventListener('submit', function() {
                loginText.style.display = 'none';
                loginSpinner.style.display = 'inline-block';
                
                // Disable form elements during submission
                const submitButton = this.querySelector('button[type="submit"]');
                submitButton.disabled = true;

                // Accessibility: Update screen reader
                submitButton.setAttribute('aria-label', 'Signing in, please wait');
                
                // Reset on error (if form doesn't redirect)
                // The timeout will re-enable the submit button if submission fails and doesn't redirect.
                // If passwordInput was not disabled, no need to re-enable it here specifically for this flow.
                setTimeout(() => {
                    loginText.style.display = 'inline';
                    loginSpinner.style.display = 'none';
                    submitButton.disabled = false;
                    // passwordInput.disabled = false; 
                    submitButton.setAttribute('aria-label', 'Sign In to Dashboard');
                }, 10000); // 10 second timeout
            });
            
            // Auto-focus password field
            passwordInput.focus();
            
            // Clear any previous error states on input
            passwordInput.addEventListener('input', function() {
                this.classList.remove('error');
                const alertError = document.querySelector('.alert-error');
                if (alertError) {
                    alertError.style.opacity = '0.5';
                }
            });
            
            // Enhanced keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && e.target.tagName !== 'BUTTON') {
                    loginForm.dispatchEvent(new Event('submit'));
                }
            });
            
            // Security: Clear form data on page unload
            window.addEventListener('beforeunload', function() {
                passwordInput.value = '';
            });
            
            // Accessibility: Announce login status to screen readers
            const errorAlert = document.querySelector('.alert-error');
            if (errorAlert) {
                errorAlert.setAttribute('role', 'alert');
                errorAlert.setAttribute('aria-live', 'polite');
            }
            
            const successAlert = document.querySelector('.alert-success');
            if (successAlert) {
                successAlert.setAttribute('role', 'status');
                successAlert.setAttribute('aria-live', 'polite');
            }
            
            // Progressive enhancement: Add loading animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes pulse {
                    0% { opacity: 1; }
                    50% { opacity: 0.5; }
                    100% { opacity: 1; }
                }
                .btn:disabled {
                    animation: pulse 1.5s ease-in-out infinite;
                }
            `;
            document.head.appendChild(style);
            
            console.log('Login page loaded - GDG EUE Event Manager');
            console.log('Security features active: CSRF protection, rate limiting, secure sessions');
        });
    </script>
</body>
</html>
